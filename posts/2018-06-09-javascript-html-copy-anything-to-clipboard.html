<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Copy anything to clipboard in HTML and JavaScript</title><meta name="description" content="Simplex Sigillum Veri"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="canonical" href="https://remusao.github.io/posts/javascript-html-copy-anything-to-clipboard.html"><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><style type="text/css">body{color:#2f2f2f;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen-Sans,Ubuntu,Cantarell,'Helvetica Neue',sans-serif;line-height:1.6em;margin:20px auto;max-width:40rem;padding:0 1.5em;text-rendering:optimizeLegibility}h1{line-height:1.1em}h2{border-bottom:1px solid #eaecef;padding-bottom:.5em}h1,h2,h3{padding-top:.7em}.header{color:#555;margin-top:-.8em}.main a{color:#3465a4}.main a:visited{color:#75507b}.main figcaption{color:#696f72;font-style:italic;line-height:2em;text-align:center}.main img{display:block;height:auto;margin:auto;padding-bottom:1em;padding-top:1em;width:90%}.main blockquote{border-left:thin solid #d3d7cf;color:#555;margin:10px;padding:0 0 0 1em}code{background-color:#f6f8fa;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:14px;line-height:20px;padding:.2em .4em}pre code{display:block;overflow-x:auto}.leave-comment-btn,summary{font-size:16px;font-weight:600}.leave-comment-btn{background-color:#28a745;background-image:linear-gradient(-180deg,#34d058,#28a745 90%);border:1px solid rgba(27,31,35,.2);border-radius:.25em;color:#fff;display:inline-block;margin-top:1.5em;padding:3px 10px;text-decoration:none}.leave-comment-btn:hover{box-shadow:0 1px 3px rgba(0,0,0,.24)}summary{color:#516ae8;cursor:pointer;line-height:1.2rem;margin-top:2rem}.comments-list{list-style:none;padding:0}.comment{background-color:#fff;border:1px solid #d1d5da;border-radius:3px;color:#24292e;font-size:16px;margin:1em 0}.meta{background-color:#f6f8fa;border-bottom:1px solid #d1d5da;color:#586069}.author,.date{text-decoration:none}.author{color:#24292e!important;font-weight:700}.date{color:#586069}.date:hover{color:#0366d6}.content{padding-left:20px}.avatar,.emoji{vertical-align:middle}.avatar{display:inline-block;margin-right:5px}.emoji{height:1.1em;width:1.1em}table{border-collapse:collapse;margin:auto}td,th{border:1px solid #ddd;padding:10px}tr:hover{background-color:#f5f5f5}footer{border-top:thin solid #d3d7cf;margin:1.5em 0}.share ul{text-align:right}.share li{display:inline;padding:0 5px}.share img{width:32px}.main a,header a{text-decoration:none}.hljs{background:#f8f8f8;color:#333;display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-quote{color:#6a737d;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#d73a49}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:#005cc5}.hljs-doctag,.hljs-string{color:#032f62}.hljs-section,.hljs-selector-id,.hljs-title{color:#900}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#6f42c1}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></head><body><main><header><h1><a href="../"><span>../</span></a></h1></header><h1>Copy anything to clipboard in HTML and JavaScript</h1><section class="header"><div>└─ 2018-06-09 • <em>Reading time: ~1 minutes</em></div></section><article><div class="main"><p>Not long ago, I was looking for a way to copy the content of any HTML element on a page to clipboard. What I thought would be an easy task turned out to be more complicated than expected. In the end I had to use some trick which I will show here.</p><p>The way this will work is as follows: when clicking an element on the page, its <code>innerText</code> will be copied to Clipboard. To achieve this we will need to:</p><ul><li>Attach an <code>onclick</code> event listener to our element (or to several elements)</li><li>When a <code>click</code> event is received, emit a fake <code>copy</code> event</li></ul><pre class="code" data-lang="javascript"><code>  <span class="hljs-comment">// This variable will be used to store a reference to the</span>
  <span class="hljs-comment">// latest element clicked.</span>
  <span class="hljs-keyword">let</span> selected = <span class="hljs-literal">null</span>;

  <span class="hljs-comment">// Attach our custom copy-to-clipboard-on-click trick to `elt`</span>
  <span class="hljs-keyword">const</span> elt = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;...&#x27;</span>);
  elt.onclick = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// Store reference to this element in the global `selected`</span>
    selected = elt;
    <span class="hljs-comment">// Emit fake `copy` event</span>
    <span class="hljs-built_in">document</span>.execCommand(<span class="hljs-string">&#x27;copy&#x27;</span>);
    <span class="hljs-comment">// Remove reference from `selected` to allow normal copies</span>
    <span class="hljs-comment">// to be performed on the page.</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> { selected = <span class="hljs-literal">null</span>; }, <span class="hljs-number">1000</span>);
  };
</code></pre><ul><li>Listen to this <code>copy</code> event and copy the content of the latest element clicked to clipboard.</li></ul><pre class="code" data-lang="javascript"><code>  <span class="hljs-comment">// Intercept copy events</span>
  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">&#x27;copy&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (selected === <span class="hljs-literal">null</span>) {
      <span class="hljs-comment">// No element was clicked</span>
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Copy content of clicked element to clipboard</span>
    e.clipboardData.setData(
      <span class="hljs-string">&#x27;text/plain&#x27;</span>,
      selected.innerText,
    );

    <span class="hljs-comment">// We want our data, not data from any selection,</span>
    <span class="hljs-comment">// to be written to the clipboard</span>
    e.preventDefault();
  });

</code></pre></div><div class="comments"><span><a class="leave-comment-btn" href="https://github.com/remusao/remusao.github.io/issues/13" title="https://github.com/remusao/remusao.github.io/issues/13" target="_blank" rel="noopener noreferrer">Leave a comment on GitHub</a></span><details><summary>2 comments</summary><ul class="comments-list"><li><div class="comment"><div class="meta"><img loading="lazy" class="avatar" src="/images/comments/avatar/76750.jpg" width="40" height="40"> <a class="author" href="https://github.com/amcgregor" title="amcgregor" target="_blank" rel="noopener noreferrer">amcgregor</a> <span>commented </span><a class="date" href="https://github.com/remusao/remusao.github.io/issues/13#issuecomment-653712564" title="https://github.com/remusao/remusao.github.io/issues/13#issuecomment-653712564" target="_blank" rel="noopener noreferrer">17 days ago</a></div><div class="content"><p>Interesting. Ran into this problem myself recently with a file upload interface and “copy short link” actions, excepting that I did not want the URI being copied present on the page. (It technically <em>is</em>, but in an abbreviated form that would not produce a viable URI. The “slashes” aren’t: they’re <code>／</code> or a Unicode FULLWIDTH SOLIDUS.)</p><p>My solution involved a “staging area” plain text input to use to place the value to be copied within. If that sentence can even English.</p><details open=""><summary><code>sample.html</code></summary><pre data-lang="html" class="code"><code><span class="hljs-comment">&lt;!-- A place to use as the origin of the copy operation. --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">id</span>=<span class="hljs-string">clipboard</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

<span class="hljs-comment">&lt;!-- Some thing to copy. --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">data-uri</span>=<span class="hljs-string">https://flffy.app/CoaE_HfG_uPXUI_d/screenshot.png</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>flffy.app／CoaE_HfG_uPXUI_d／screenshot.png<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"copy fad fa-link"</span>&gt;</span>Copy Link<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</code></pre></details><p>The CSS <code>display: none</code> and <code>visibility: hidden</code> often have unintentional side-effects, especially the <code>display</code> one, so we utilize other means to make our input invisible. (We don’t want to prevent pseudo-keyboard—shortcut—interaction automation from working.)</p><details><summary><code>sample.css</code></summary><pre data-lang="css" class="code"><code><span class="hljs-selector-tag">textarea</span><span class="hljs-selector-id">#clipboard</span> {
	<span class="hljs-attribute">width</span>: <span class="hljs-number">1px</span>;
	<span class="hljs-attribute">height</span>: <span class="hljs-number">1px</span>;
	<span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
	<span class="hljs-attribute">position</span>: absolute;
	<span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
	<span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>
}
</code></pre></details><p>Use of a “staging” hidden input field (visually; not literally <code>type=hidden</code>) ensures rich text media will not be sent to the clipboard. (Always love pasting “Read more…” that happens to be a link, instead of the link, into a non-rich-text input… and you did indeed read that right.) This can be especially egregious if font, font color, and background information gets copied.</p><p>The technique is otherwise similar in that it utilizes the same underlying <code>execCommand</code> invocation, but without having to intercept such invocations to manipulate <code>clipboardData</code> directly:</p><details open=""><summary><code>sample.js</code></summary><pre data-lang="js" class="code"><code><span class="hljs-comment">// Attaching to the body allows capture of "bubbled" events.</span>
<span class="hljs-comment">// It saves worrying about binding the handler to each individually, and</span>
<span class="hljs-comment">// to any dynamic elements as they are added.</span>
<span class="hljs-built_in">document</span>.body.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
	<span class="hljs-comment">// We "exit early" if the element clicked isn't of interest to us.</span>
	<span class="hljs-keyword">if</span> ( !e.target.classList.contains(<span class="hljs-string">'copy'</span>) ) <span class="hljs-keyword">return</span>
	<span class="hljs-keyword">let</span> elem = e.target.matches(<span class="hljs-string">'li[data-uri]'</span>) ? e.target : e.target.closest(<span class="hljs-string">'li[data-uri]'</span>)
	<span class="hljs-keyword">if</span> ( !elem ) <span class="hljs-keyword">return</span>
	
	<span class="hljs-comment">// My use-case: copy the data-uri property from the clicked</span>
	<span class="hljs-comment">// element... or the nearest parent element having one.</span>
	clipboard.innerText = elem.dataset.uri
	clipboard.select()
	<span class="hljs-built_in">document</span>.execCommand(<span class="hljs-string">"copy"</span>)
	clipboard.blur()
})
</code></pre></details><p>Note also several shortcuts utilized: arrow functions because they’re darned nice, like your sample, but with a notable lack of <code>getElementById</code> despite using an HTML element for the stage… HTML elements identified with JavaScript symbol-safe names are exposed as attributes of the <code>window</code> object: global variables. Also: who needs semicolons? 😉</p><p>Visually, the prototype looked like: (in dark mode)</p><p><img src="https://user-images.githubusercontent.com/76750/86503981-88191f00-bd81-11ea-960a-df9a92f015d2.png" alt="Screen Shot 2020-07-03 at 22 39 41" width="100%"></p><p>One deficit that could be corrected: this does not restore any prior focus or selection… but it could be extended to. Edited to add: though an arbitrary “one second timeout” to do so would be exceptionally sub-optimal, IMO. Similar to link analytics services like Google Analytics literally delaying every link on your page by 200ms just to ensure the XHR gets out. <strong>Not good!</strong> 😜</p></div></div></li><li><div class="comment"><div class="meta"><img loading="lazy" class="avatar" src="/images/comments/avatar/1299873.jpg" width="40" height="40"> <a class="author" href="https://github.com/remusao" title="remusao" target="_blank" rel="noopener noreferrer">remusao</a> <span>commented </span><a class="date" href="https://github.com/remusao/remusao.github.io/issues/13#issuecomment-653790561" title="https://github.com/remusao/remusao.github.io/issues/13#issuecomment-653790561" target="_blank" rel="noopener noreferrer">16 days ago</a></div><div class="content"><p>Very nice. Thank you for sharing! Regarding the timeout, I am not sure why I did not simply clear the global reference in the ‘copy’ listener, I guess it should always trigger…</p></div></div></li></ul></details></div></article><footer><div class="share"><ul><li><a href="https://www.facebook.com/sharer/sharer.php?u=https://remusao.github.io//posts/javascript-html-copy-anything-to-clipboard.html&t=Copy anything to clipboard in HTML and JavaScript" title="Share on Facebook" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Share on Facebook" src="/images/social_flat_rounded_rects_svg/Facebook.svg"><a></a></li><li><a href="https://twitter.com/share?url=https://remusao.github.io//posts/javascript-html-copy-anything-to-clipboard.html&text=Copy anything to clipboard in HTML and JavaScript&via=Pythux" title="Tweet" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Tweet" src="/images/social_flat_rounded_rects_svg/Twitter.svg"><a></a></li><li><a href="https://getpocket.com/save?url=https://remusao.github.io//posts/javascript-html-copy-anything-to-clipboard.html&title=Copy anything to clipboard in HTML and JavaScript" title="Add to Pocket" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Add to Pocket" src="/images/social_flat_rounded_rects_svg/Pocket.svg"><a></a></li><li><a href="https://news.ycombinator.com/submitlink?u=https://remusao.github.io//posts/javascript-html-copy-anything-to-clipboard.html&t=Copy anything to clipboard in HTML and JavaScript" title="Submit to Hacker News" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Submit to Hacker News" src="/images/social_flat_rounded_rects_svg/HackerNews.svg"><a></a></li><li><a href="https://www.reddit.com/submit?url=https://remusao.github.io//posts/javascript-html-copy-anything-to-clipboard.html&title=Copy anything to clipboard in HTML and JavaScript" title="Submit to Reddit" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Submit to Reddit" src="/images/social_flat_rounded_rects_svg/Reddit.svg"><a></a></li></ul></div></footer></main></body></html>